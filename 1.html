<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Christmas LATAM Event ‚Äì Rewards & Ranking</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #050516;
      --accent: #ffcc33;
      --accent2: #ff4d6a;
      --accent3: #3cf5ff;
      --accent4: #4ade80;
      --text: #f9fafb;
      --muted: #a5b4fc;
      --card: #0e1023;
      --border: rgba(148, 163, 184, 0.6);
      --nav-height: 74px;
      --radius-lg: 22px;
      --shadow-strong: 0 20px 50px rgba(0, 0, 0, 0.85);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at 10% 0%, #ff4d6a 0, transparent 60%),
        radial-gradient(circle at 90% 100%, #22c55e 0, transparent 60%),
        linear-gradient(180deg, #020617 0%, #020617 50%, #050516 100%);
      color: var(--text);
      display: flex;
      justify-content: center;
      padding: 18px 10px calc(20px + var(--nav-height));
      overflow-x: hidden;
    }

    .app-shell {
      width: 100%;
      max-width: 1200px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.16), transparent 55%),
        radial-gradient(circle at 120% 0, rgba(59, 130, 246, 0.35), transparent 65%),
        linear-gradient(145deg, rgba(3, 7, 18, 0.95), #020617);
      border-radius: 26px;
      border: 1px solid rgba(248, 250, 252, 0.1);
      box-shadow: var(--shadow-strong);
      padding: 16px 16px 18px;
      position: relative;
      overflow: hidden;
    }

    .app-shell::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(circle at 0 100%, rgba(255, 255, 255, 0.06) 0, transparent 60%),
        radial-gradient(circle at 100% 0, rgba(59, 130, 246, 0.12) 0, transparent 60%);
      opacity: 0.7;
      pointer-events: none;
    }

    .app-inner {
      position: relative;
      z-index: 1;
    }

    /* Snow confetti */
    .snowflake {
      position: fixed;
      top: -10px;
      color: #e0f2fe;
      font-size: 10px;
      opacity: 0.7;
      pointer-events: none;
      z-index: 3;
      animation-name: snowFall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }
    @keyframes snowFall {
      0% { transform: translateY(-10px); opacity: 0; }
      15% { opacity: 1; }
      100% { transform: translateY(110vh); opacity: 0; }
    }

    /* HEADER */

    .hero {
      display: grid;
      grid-template-columns: minmax(0, 1.8fr) minmax(0, 1.1fr);
      gap: 14px;
      align-items: center;
      margin-bottom: 14px;
    }
    @media (max-width: 800px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .hero-main {
      padding: 10px 13px;
      border-radius: 18px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.2), transparent 55%),
        linear-gradient(135deg, #020617, #111827);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    .hero-main::before {
      content: "";
      position: absolute;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(250, 204, 21, 0.4), transparent 70%);
      top: -160px;
      right: -80px;
      opacity: 0.7;
    }

    .hero-tagline {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      background: linear-gradient(90deg, #22c55e, #22d3ee);
      color: #022c22;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      font-weight: 700;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.75);
    }
    .hero-tagline span.icon {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #0f172a;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #a7f3d0;
      font-size: 12px;
    }

    .hero-title {
      margin-top: 6px;
      font-size: 26px;
      line-height: 1.1;
      font-family: "Baloo 2", cursive;
      text-shadow: 0 4px 0 #000, 0 10px 20px rgba(0, 0, 0, 0.9);
    }

    .hero-title span.highlight {
      background: linear-gradient(110deg, #fef3c7, #fb7185, #a5b4fc);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .hero-sub {
      margin-top: 4px;
      font-size: 12px;
      color: var(--muted);
    }

    .hero-pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
      font-size: 11px;
    }

    .hero-pill {
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .hero-pill span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
    }

    .hero-side {
      padding: 10px 12px;
      border-radius: 18px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.24), transparent 60%),
        linear-gradient(145deg, #0f172a, #020617);
      border: 1px solid rgba(148, 163, 184, 0.8);
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .hero-side-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      color: #e5e7eb;
      opacity: 0.9;
    }

    .hero-countdown {
      font-size: 20px;
      font-family: "Baloo 2", cursive;
      color: var(--accent3);
    }

    .hero-side span.meta {
      font-size: 11px;
      color: var(--muted);
    }

    .hero-side-footer {
      margin-top: 4px;
      font-size: 10px;
      color: #fef3c7;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .hero-side-footer span.dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.8);
    }

    /* TABS PANELS */

    .tab-panel { display: none; }
    .tab-panel.active { display: block; }

    .panel {
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.16), transparent 60%),
        linear-gradient(145deg, rgba(15, 23, 42, 0.98), #020617);
      border-radius: var(--radius-lg);
      padding: 10px 12px 12px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      box-shadow: 0 15px 32px rgba(0, 0, 0, 0.85);
    }

    /* HOME TAB */

    .home-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
      gap: 10px;
      margin-top: 6px;
    }
    @media (max-width: 820px) {
      .home-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .home-title {
      font-size: 18px;
      font-family: "Baloo 2", cursive;
    }
    .home-sub {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .banner-card {
      position: relative;
      border-radius: 18px;
      padding: 10px 12px 12px;
      overflow: hidden;
      color: #f9fafb;
    }

    .banner-card.checkin {
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.2), transparent 55%),
        linear-gradient(135deg, #f97316, #ef4444);
    }
    .banner-card.turnover {
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.2), transparent 55%),
        linear-gradient(135deg, #22c55e, #22d3ee);
    }

    .banner-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        120deg,
        rgba(15, 23, 42, 0.25) 0,
        rgba(15, 23, 42, 0.25) 1px,
        transparent 1px,
        transparent 4px
      );
      mix-blend-mode: screen;
      opacity: 0.6;
      pointer-events: none;
    }

    .banner-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      opacity: 0.95;
    }

    .banner-heading {
      margin-top: 4px;
      font-size: 16px;
      font-weight: 700;
    }

    .banner-text {
      margin-top: 3px;
      font-size: 11px;
    }

    .banner-footer {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 10px;
    }

    .banner-cta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .banner-cta {
      border: 0;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 11px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.96);
      color: #facc15;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.85);
    }
    .banner-cta.secondary {
      color: #e5e7eb;
      border: 1px solid rgba(226, 232, 240, 0.6);
      background: rgba(15, 23, 42, 0.6);
    }
    .banner-cta span.chevron {
      font-size: 13px;
      transform: translateY(1px);
    }

    /* REWARDS TAB */

    .month-progress {
      margin-bottom: 12px;
    }

    .month-head-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 4px;
    }
    .month-head-row strong { color: var(--text); }

    .month-bar-wrap {
      position: relative;
      height: 34px;
      border-radius: 999px;
      background: linear-gradient(135deg, #020617, #020617);
      border: 1px solid var(--border);
      overflow: hidden;
      padding: 9px 10px;
    }

    .month-bar-fill {
      position: absolute;
      inset: 0;
      transform-origin: left;
      background: linear-gradient(90deg, #22c55e, #a3e635, #facc15);
      filter: drop-shadow(0 0 14px rgba(250, 204, 21, 0.8));
    }

    .week-badges {
      position: relative;
      z-index: 1;
      height: 100%;
    }

    .week-badge {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 9px;
      color: var(--muted);
    }

    .week-dot {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 1px solid rgba(148, 163, 184, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      background: #020617;
    }

    .week-badge.complete .week-dot {
      background: #22c55e;
      color: #022c22;
      position: relative;
    }
    .week-badge.complete .week-dot::after {
      content: "‚úì";
      font-size: 11px;
    }

    .week-badge.active .week-dot {
      background: #facc15;
      color: #1e1307;
      animation: pulseBadge 1.6s infinite ease-in-out;
    }

    @keyframes pulseBadge {
      0%, 100% { box-shadow: 0 0 0 0 rgba(250, 204, 21, 0.7); }
      50% { box-shadow: 0 0 0 6px rgba(250, 204, 21, 0); }
    }

    .month-foot-row {
      margin-top: 3px;
      font-size: 11px;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }
    .month-foot-row strong { color: var(--accent4); }

    .weekly-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 10px;
    }

    .weekly-header h3 {
      margin: 0;
      font-size: 16px;
      font-family: "Baloo 2", cursive;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .weekly-header h3 span.badge {
      font-size: 12px;
    }
    .weekly-sub {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .weekly-chip {
      padding: 4px 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, #22c55e, #3b82f6);
      font-size: 11px;
      font-weight: 700;
      color: #022c22;
      white-space: nowrap;
      border: 1px solid rgba(191, 219, 254, 0.9);
    }

    .week-strip {
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 12px;
    }
    @media (max-width: 880px) {
      .week-strip {
        grid-template-columns: repeat(auto-fit, minmax(95px, 1fr));
      }
    }

    .day-card {
      position: relative;
      border-radius: 16px;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.15), transparent 55%),
                  linear-gradient(145deg, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.7);
      padding: 7px 7px 9px;
      font-size: 11px;
      text-align: left;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease, opacity 0.12s ease;
      overflow: hidden;
    }

    .day-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.8);
    }

    .day-top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 4px;
    }
    .day-name {
      font-weight: 600;
      font-size: 11px;
    }
    .day-date {
      font-size: 9px;
      color: var(--muted);
    }

    .day-main {
      display: flex;
      gap: 6px;
      align-items: center;
      margin-top: 4px;
    }
    .day-icon {
      width: 24px;
      height: 24px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle, rgba(248, 250, 252, 0.18), transparent 65%);
      font-size: 16px;
    }
    .day-info-text {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }
    .day-reward-name {
      font-size: 11px;
    }
    .day-reward-amount {
      font-size: 10px;
      color: var(--accent);
    }
    .day-state {
      margin-top: 4px;
      font-size: 10px;
      color: var(--muted);
    }

    .day-card.locked {
      opacity: 0.55;
      border-style: dashed;
    }
    .day-card.past {
      filter: grayscale(0.2);
      opacity: 0.9;
    }
    .day-card.today {
      border-color: #facc15;
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.9), 0 14px 26px rgba(250, 204, 21, 0.9);
      animation: dayFloat 2.4s infinite ease-in-out;
    }
    @keyframes dayFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }
    .day-card.active {
      border-color: var(--accent3);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9), 0 14px 30px rgba(56, 189, 248, 0.9);
    }

    .day-info-icon-wrap {
      position: absolute;
      top: 6px;
      right: 6px;
    }
    .day-info-icon {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.8);
    }

    /* Selected reward card */

    .selected-card {
      border-radius: 18px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.18), transparent 60%),
        linear-gradient(145deg, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.8);
      padding: 10px 10px 10px;
      display: grid;
      grid-template-columns: auto minmax(0, 1.3fr) minmax(0, 1.3fr);
      gap: 10px;
      align-items: center;
      position: relative;
      overflow: hidden;
    }
    .selected-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 100% 0, rgba(96, 165, 250, 0.35), transparent 55%);
      opacity: 0.7;
      pointer-events: none;
    }
    @media (max-width: 720px) {
      .selected-card {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .selected-icon {
      font-size: 38px;
      width: 52px;
      height: 52px;
      border-radius: 18px;
      background: linear-gradient(135deg, #facc15, #fb7185);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #1e1307;
      box-shadow: 0 14px 28px rgba(0,0,0,0.9);
      position: relative;
      z-index: 1;
    }

    .selected-main {
      position: relative;
      z-index: 1;
    }
    .selected-main h3 {
      margin: 0;
      font-size: 17px;
      font-family: "Baloo 2", cursive;
    }
    .selected-main .amount {
      font-size: 15px;
      color: var(--accent);
      margin-top: 3px;
    }
    .selected-main .tagline {
      font-size: 11px;
      color: var(--muted);
      margin-top: 3px;
    }

    .selected-meta {
      position: relative;
      z-index: 1;
      font-size: 11px;
      color: var(--muted);
      display: grid;
      gap: 4px;
    }
    .selected-meta span strong {
      color: var(--accent3);
    }

    .btn {
      border: 0;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 11px;
      font-weight: 700;
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: linear-gradient(135deg, #3cf5ff, #6366f1);
      color: #020617;
      box-shadow: 0 10px 22px rgba(37, 99, 235, 0.8);
      margin-top: 4px;
    }
    .btn[disabled] {
      opacity: 0.45;
      box-shadow: none;
      cursor: default;
    }

    /* Info modal */

    .info-modal {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease;
      z-index: 30;
    }
    .info-modal.show {
      opacity: 1;
      pointer-events: auto;
    }

    .info-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(15, 23, 42, 0.88);
      backdrop-filter: blur(4px);
    }

    .info-panel {
      position: relative;
      width: 90%;
      max-width: 360px;
      border-radius: 18px;
      padding: 10px 12px 12px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.22), transparent 60%),
        linear-gradient(145deg, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.9);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.95);
      transform: translateY(8px);
      transition: transform 0.18s ease;
      color: #e5e7eb;
      font-size: 11px;
      z-index: 31;
    }
    .info-modal.show .info-panel {
      transform: translateY(0);
    }

    .info-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }
    .info-header h4 {
      margin: 0;
      font-size: 13px;
      font-family: "Baloo 2", cursive;
    }
    .info-close {
      border: 0;
      background: transparent;
      color: #9ca3af;
      font-size: 15px;
      cursor: pointer;
    }
    .info-body strong {
      display: block;
      color: #38bdf8;
      margin-bottom: 3px;
    }
    .info-body ul {
      padding-left: 16px;
      margin: 4px 0 0;
    }
    .info-body li {
      margin: 2px 0;
    }

    /* RANKING TAB */

    .ranking-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 8px;
    }
    .ranking-heading {
      font-size: 16px;
      font-family: "Baloo 2", cursive;
    }
    .ranking-sub {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }
    .ranking-chip {
      padding: 4px 9px;
      border-radius: 999px;
      background: linear-gradient(135deg, #facc15, #fb7185);
      border: 1px solid rgba(254, 243, 199, 0.9);
      font-size: 10px;
      font-weight: 700;
      color: #1f1307;
      white-space: nowrap;
    }

    .ranking-updated {
      font-size: 10px;
      color: var(--muted);
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid var(--border);
      white-space: nowrap;
    }

    .ranking-grid {
      display: grid;
      grid-template-columns: minmax(0, 0.9fr) minmax(0, 1.1fr);
      gap: 10px;
      align-items: start;
    }
    @media (max-width: 880px) {
      .ranking-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .podium-card {
      border-radius: 18px;
      background:
        radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.2), transparent 60%),
        linear-gradient(135deg, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.9);
      padding: 8px 8px 10px;
    }

    .podium-title {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }
    .podium-title strong { color: var(--text); }

    .podium-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .podium-item {
      position: relative;
      border-radius: 16px;
      padding: 8px 6px 10px;
      text-align: center;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.14), transparent 70%),
                  linear-gradient(180deg, #020617, #020617);
      border: 1px solid rgba(148, 163, 184, 0.9);
    }
    .podium-item.rank-1 {
      background: linear-gradient(180deg, #facc15, #fb7185);
      color: #1f1307;
      transform: translateY(-4px);
      box-shadow: 0 16px 34px rgba(0,0,0,0.95);
    }

    .podium-rank {
      position: absolute;
      top: 4px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 999px;
      padding: 2px 9px;
      font-size: 10px;
      background: rgba(0, 0, 0, 0.6);
      color: #fef9c3;
      border: 1px solid rgba(248, 250, 252, 0.8);
    }

    .podium-avatar {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      margin: 14px auto 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(248, 250, 252, 0.9);
      background: radial-gradient(circle, rgba(248, 250, 252, 0.28), transparent 65%);
      font-size: 16px;
    }

    .podium-name {
      font-size: 12px;
      font-weight: 700;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .podium-turnover {
      font-size: 11px;
      margin-top: 2px;
    }

    .ranking-table-card {
      border-radius: 18px;
      background: #020617;
      border: 1px solid var(--border);
      padding: 8px 8px 10px;
    }

    .search-row {
      display: flex;
      gap: 6px;
      margin-bottom: 4px;
    }
    .search-row input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(191, 219, 254, 0.9);
      background: #020617;
      color: var(--text);
      font-size: 11px;
      padding: 6px 10px;
      outline: none;
    }
    .search-row input::placeholder {
      color: #64748b;
    }
    .search-row button {
      border-radius: 999px;
      border: 0;
      padding: 6px 10px;
      font-size: 11px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      color: #022c22;
      box-shadow: 0 10px 22px rgba(34, 197, 94, 0.8);
      white-space: nowrap;
    }

    .search-result {
      min-height: 14px;
      font-size: 10px;
      color: var(--muted);
    }
    .search-result strong { color: var(--accent3); }

    .table-head-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
      margin: 4px 0;
    }

    .ranking-list {
      max-height: 240px;
      overflow-y: auto;
      border-radius: 14px;
    }
    .ranking-row {
      display: grid;
      grid-template-columns: 30px minmax(0, 1fr) minmax(0, 80px);
      gap: 6px;
      align-items: center;
      font-size: 10px;
      padding: 5px 6px;
      background: #020617;
    }
    .ranking-row:nth-child(even) { background: #040718; }
    .ranking-row.highlight {
      border: 1px solid var(--accent3);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9), 0 12px 26px rgba(56, 189, 248, 0.9);
      position: relative;
      z-index: 1;
    }

    .rank-badge {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle, rgba(248, 250, 252, 0.16), transparent 60%);
    }

    .rank-main {
      display: flex;
      align-items: center;
      gap: 6px;
      overflow: hidden;
    }
    .rank-avatar {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle, rgba(248, 250, 252, 0.25), transparent 60%);
      font-size: 11px;
    }
    .rank-name {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-weight: 600;
    }
    .rank-turnover {
      text-align: right;
      font-weight: 600;
    }
    .rank-turnover span.label {
      display: block;
      font-size: 8px;
      color: #64748b;
      font-weight: 400;
    }

    /* BOTTOM NAV */

    .bottom-nav {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: var(--nav-height);
      display: flex;
      justify-content: center;
      pointer-events: none;
      z-index: 40;
    }
    .bottom-nav-inner {
      pointer-events: auto;
      width: 100%;
      max-width: 1200px;
      padding: 8px 12px 0;
    }
    .bottom-bar {
      background: rgba(3, 7, 18, 0.97);
      border-radius: 20px 20px 0 0;
      border: 1px solid rgba(30, 64, 175, 0.9);
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 6px 8px 8px;
      box-shadow: 0 -10px 26px rgba(0, 0, 0, 0.9);
    }

    .nav-btn {
      flex: 1;
      border: 0;
      background: transparent;
      color: #9ca3af;
      font-size: 11px;
      font-family: inherit;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      cursor: pointer;
      transition: color 0.16s ease, transform 0.16s ease;
    }

    .nav-icon {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 1.8;
      fill: none;
      transition: transform 0.16s ease;
    }

    .nav-btn.active {
      color: #f9fafb;
      transform: translateY(-1px);
    }
    .nav-btn.active .nav-icon {
      color: var(--accent);
      transform: scale(1.18);
    }

    /* TOAST */
    .toast {
      position: fixed;
      left: 50%;
      bottom: calc(var(--nav-height) + 16px);
      transform: translateX(-50%) translateY(10px);
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.15), transparent 60%),
                  linear-gradient(135deg, #22c55e, #16a34a);
      color: #022c22;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 700;
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.9);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease, transform 0.18s ease;
      z-index: 50;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Scrollbars */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #020617;
    }
    ::-webkit-scrollbar-thumb {
      background: #4b5563;
      border-radius: 999px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }
  </style>
</head>
<body>
  <!-- Snow / confetti -->
  <script>
    (function snow() {
      const count = 40;
      for (let i = 0; i < count; i++) {
        const f = document.createElement("div");
        f.className = "snowflake";
        f.textContent = "‚ú∂";
        const left = Math.random() * 100;
        const duration = 7 + Math.random() * 8;
        const delay = Math.random() * -duration;
        const size = 6 + Math.random() * 6;
        f.style.left = left + "vw";
        f.style.fontSize = size + "px";
        f.style.animationDuration = duration + "s";
        f.style.animationDelay = delay + "s";
        document.body.appendChild(f);
      }
    })();
  </script>

  <div class="app-shell">
    <div class="app-inner">
      <!-- HERO -->
      <section class="hero">
        <div class="hero-main">
          <div class="hero-tagline">
            <span class="icon">‚òÖ</span>
            <span>LATAM Christmas Fiesta</span>
          </div>
          <div class="hero-title">
            Christmas <span class="highlight">Month Event</span>
          </div>
          <div class="hero-sub">
            Conecta todos los d√≠as, reclama tu recompensa y sube posiciones en el ranking de turnover.
          </div>
          <div class="hero-pill-row">
            <div class="hero-pill">
              <span class="dot"></span>
              <span>Daily check-in calendar</span>
            </div>
            <div class="hero-pill">
              <span class="dot" style="background:#fb7185;"></span>
              <span>Live turnover challenge</span>
            </div>
          </div>
        </div>

        <aside class="hero-side">
          <span class="hero-side-label">Pr√≥ximo regalo en</span>
          <span id="nextRewardTime" class="hero-countdown">--:--:--</span>
          <span class="meta">El siguiente drop se habilita a las 00:00 (hora del servidor).</span>
          <div class="hero-side-footer">
            <span class="dot"></span>
            <span>Inicia sesi√≥n diario para mantener tu racha.</span>
          </div>
        </aside>
      </section>

      <!-- HOME TAB -->
      <section id="tab-home" class="tab-panel active">
        <section class="panel">
          <div class="home-title">Bienvenido al hub del evento üéâ</div>
          <div class="home-sub">
            Elige tu misi√≥n de hoy: reclamar recompensa del calendario o empujar tu turnover al top 20.
          </div>
          <div class="home-grid">
            <!-- Check-in banner -->
            <article class="banner-card checkin">
              <div class="banner-label">Misi√≥n 01 ‚Ä¢ Check-in Diario</div>
              <div class="banner-heading">Calendario de Recompensas</div>
              <div class="banner-text">
                Cada d√≠a de diciembre desbloquea monedas, giros y cofres semanales especiales. ¬°No pierdas tu streak!
              </div>
              <div class="banner-footer">
                <span>Completa las 5 semanas para un bonus extra.</span>
                <div class="banner-cta-row">
                  <button class="banner-cta" data-goto-tab="rewards">
                    <span>Ver calendario</span>
                    <span class="chevron">‚Ä∫</span>
                  </button>
                </div>
              </div>
            </article>

            <!-- Turnover banner -->
            <article class="banner-card turnover">
              <div class="banner-label">Misi√≥n 02 ‚Ä¢ Reto de Turnover</div>
              <div class="banner-heading">Ranking Diario LATAM</div>
              <div class="banner-text">
                Juega, gira y raidea para subir tu turnover. Los mejores jugadores entran al podio y desbloquean premios extra.
              </div>
              <div class="banner-footer">
                <span>Top 3 salen en grande, top 20 en la tabla.</span>
                <div class="banner-cta-row">
                  <button class="banner-cta secondary" data-goto-tab="ranking">
                    <span>Ver ranking</span>
                    <span class="chevron">‚Ä∫</span>
                  </button>
                </div>
              </div>
            </article>
          </div>
        </section>
      </section>

      <!-- REWARDS TAB -->
      <section id="tab-rewards" class="tab-panel">
        <section class="panel">
          <!-- Month progress -->
          <div class="month-progress">
            <div class="month-head-row">
              <strong>Progreso Diciembre</strong>
              <span id="monthSummary">Day 0 / 31</span>
            </div>
            <div class="month-bar-wrap">
              <div class="month-bar-fill" id="monthFill"></div>
              <div class="week-badges" id="weekBadges"></div>
            </div>
            <div class="month-foot-row">
              <span>5 semanas cubren todo diciembre.</span>
              <span>Completa una semana para encender su <strong>insignia</strong>.</span>
            </div>
          </div>

          <!-- Week 1 -->
          <div class="weekly-header">
            <div>
              <h3>
                <span>Semana 1</span>
                <span class="badge">1‚Äì7 Dic</span>
              </h3>
              <div class="weekly-sub">
                Los d√≠as pasados se ven en gris, el d√≠a de hoy brilla y los d√≠as futuros se muestran bloqueados.
              </div>
            </div>
            <div class="weekly-chip">Tap un d√≠a para ver detalles & c√≥digo</div>
          </div>

          <div id="weekStrip" class="week-strip"></div>

          <div id="selectedCard" class="selected-card"></div>
        </section>
      </section>

      <!-- RANKING TAB -->
      <section id="tab-ranking" class="tab-panel">
        <section class="panel">
          <header class="ranking-header">
            <div>
              <div class="ranking-heading">Ranking de Turnover Diario</div>
              <div class="ranking-sub">
                Los 3 primeros suben al podio, top 20 aparece en la tabla. Actualizado desde Google Sheet del evento.
              </div>
            </div>
            <div>
              <div class="ranking-chip">Premios extra para Top 3</div>
              <div id="updatedAt" class="ranking-updated">Actualizado ‚Äì</div>
            </div>
          </header>

          <div class="ranking-grid">
            <div class="podium-card">
              <div class="podium-title">
                <strong>Podio de hoy</strong>
                <span>¬°Felicitaciones, campeones!</span>
              </div>
              <div id="podiumGrid" class="podium-grid"></div>
            </div>

            <div class="ranking-table-card">
              <div class="search-row">
                <input id="searchInput" placeholder="Busca tu usuario (GitHub / in-game)..." />
                <button id="searchBtn">Buscar</button>
              </div>
              <div id="searchResult" class="search-result"></div>

              <div class="table-head-row">
                <span>Top 20 Turnover</span>
                <span>Lista completa en Google Sheet</span>
              </div>

              <div id="rankingList" class="ranking-list"></div>
            </div>
          </div>
        </section>
      </section>
    </div>
  </div>

  <!-- Bottom nav -->
  <nav class="bottom-nav">
    <div class="bottom-nav-inner">
      <div class="bottom-bar">
        <button class="nav-btn active" data-tab-target="home">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path d="M4 10.5L12 4l8 6.5V20a1 1 0 0 1-1 1h-4.5a.5.5 0 0 1-.5-.5V15a2 2 0 0 0-2-2h-1a2 2 0 0 0-2 2v5.5a.5.5 0 0 1-.5.5H5a1 1 0 0 1-1-1v-9.5z" />
          </svg>
          <span>Inicio</span>
        </button>

        <button class="nav-btn" data-tab-target="rewards">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <rect x="3.5" y="5" width="17" height="15.5" rx="2" />
            <path d="M8 3.5v3M16 3.5v3M3.5 9h17" />
          </svg>
          <span>Rewards</span>
        </button>

        <button class="nav-btn" data-tab-target="ranking">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path d="M8 21v-6.5M12 21V5M16 21v-9" />
            <path d="M7 9h10l-1.3-5H8.3z" />
          </svg>
          <span>Ranking</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Toast -->
  <div id="toast" class="toast">C√≥digo copiado</div>

  <!-- Info modal -->
  <div id="infoModal" class="info-modal">
    <div class="info-backdrop"></div>
    <div class="info-panel">
      <div class="info-header">
        <h4 id="infoModalTitle">Day 1 ‚Äì Reward</h4>
        <button id="infoModalClose" class="info-close">‚úï</button>
      </div>
      <div id="infoModalBody" class="info-body"></div>
    </div>
  </div>

  <script>
    // ---- countdown ----
    const nextRewardTimeEl = document.getElementById("nextRewardTime");
    function updateCountdown() {
      const now = new Date();
      const next = new Date();
      next.setHours(24, 0, 0, 0);
      const diff = next - now;
      if (diff <= 0) {
        nextRewardTimeEl.textContent = "00:00:00";
        return;
      }
      const h = String(Math.floor(diff / 3_600_000)).padStart(2, "0");
      const m = String(Math.floor((diff / 60_000) % 60)).padStart(2, "0");
      const s = String(Math.floor((diff / 1000) % 60)).padStart(2, "0");
      nextRewardTimeEl.textContent = `${h}:${m}:${s}`;
    }
    updateCountdown();
    setInterval(updateCountdown, 1000);

    // ---- December context ----
    const today = new Date();
    const currentYear = today.getFullYear();
    const DECEMBER = 11; // 0-indexed
    const isDecember = today.getMonth() === DECEMBER;

    // For testing: change demoDay to simulate a date.
    const demoDay = 3;
    const decDayToday = isDecember ? today.getDate() : demoDay;
    const todayInDecember = Math.min(Math.max(decDayToday, 1), 31);

    // ---- Month progress ----
    const totalDaysDec = 31;
    const monthFill = document.getElementById("monthFill");
    const monthSummary = document.getElementById("monthSummary");
    const weekBadgesEl = document.getElementById("weekBadges");

    if (monthFill) {
      const progress = todayInDecember / totalDaysDec;
      monthFill.style.transform = `scaleX(${progress})`;
      monthSummary.textContent = `Day ${todayInDecember} / ${totalDaysDec}`;

      const weeks = [
        { label: "W1", start: 1, end: 7 },
        { label: "W2", start: 8, end: 14 },
        { label: "W3", start: 15, end: 21 },
        { label: "W4", start: 22, end: 28 },
        { label: "W5", start: 29, end: 31 }
      ];

      weeks.forEach((w, idx) => {
        const mid = (w.start + w.end) / 2;
        const left = (mid / totalDaysDec) * 100;
        const status =
          todayInDecember >= w.end
            ? "complete"
            : todayInDecember >= w.start
            ? "active"
            : "upcoming";
        const badge = document.createElement("div");
        badge.className = `week-badge ${status}`;
        badge.style.left = left + "%";
        badge.innerHTML = `
          <div class="week-dot">${idx + 1}</div>
          <div>${w.label}</div>
        `;
        weekBadgesEl.appendChild(badge);
      });
    }

    // ---- Week 1 rewards ----
    const weekStrip = document.getElementById("weekStrip");
    const selectedCard = document.getElementById("selectedCard");
    const weekdayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
    const decYear = currentYear;

    const voucherCodes = {};
    for (let d = 1; d <= 31; d++) {
      voucherCodes[d] = `DEC${String(d).padStart(2, "0")}-LATAM`;
    }

    const weekRewards = [
      {
        day: 1,
        icon: "üí∞",
        name: "Coin Pack Inicio",
        amount: "350M",
        tagline: "Empieza diciembre con un buen boost de monedas.",
        infoHtml: `
          <strong>Drop diario ‚Äì Coin Pack</strong>
          <ul>
            <li>Hasta <b>350M</b> monedas extra</li>
            <li>VIP 01‚Äì03: 50M monedas</li>
            <li>VIP 04‚Äì05: 150M monedas</li>
            <li>VIP 06+: 350M monedas</li>
          </ul>`
      },
      {
        day: 2,
        icon: "‚ö°",
        name: "Energy Fiesta",
        amount: "80x",
        tagline: "M√°s raids para seguir la fiesta.",
        infoHtml: `
          <strong>Drop diario ‚Äì Free Spins</strong>
          <ul>
            <li>Hasta <b>100 Free Spins</b></li>
            <li>VIP 01‚Äì03: 20 Free Spins</li>
            <li>VIP 04‚Äì05: 50 Free Spins</li>
            <li>VIP 06+: 100 Free Spins</li>
          </ul>`
      },
      {
        day: 3,
        icon: "üéÅ",
        name: "Loot Crate √âpico",
        amount: "Epic",
        tagline: "Cofre con recompensas √©picas al azar.",
        infoHtml: `
          <strong>Drop diario ‚Äì Epic Loot Crate</strong>
          <ul>
            <li>Hasta <b>3 √≠tems √©picos</b></li>
            <li>VIP 01‚Äì03: 1 √≠tem √©pico</li>
            <li>VIP 04‚Äì05: 2 √≠tems √©picos</li>
            <li>VIP 06+: 3 √≠tems √©picos + monedas extra</li>
          </ul>`
      },
      {
        day: 4,
        icon: "üß™",
        name: "Turnover Boost",
        amount: "2x",
        tagline: "Multiplica tu turnover por un tiempo limitado.",
        infoHtml: `
          <strong>Drop diario ‚Äì Turnover Boost</strong>
          <ul>
            <li>Hasta <b>2x turnover</b> por 2 horas</li>
            <li>VIP 01‚Äì03: 2x por 30 min</li>
            <li>VIP 04‚Äì05: 2x por 1 hora</li>
            <li>VIP 06+: 2x por 2 horas</li>
          </ul>`
      },
      {
        day: 5,
        icon: "üíé",
        name: "Gem Drop",
        amount: "120",
        tagline: "Gemas para desbloquear perks premium.",
        infoHtml: `
          <strong>Drop diario ‚Äì Gem Pack</strong>
          <ul>
            <li>Hasta <b>120 Gemas</b></li>
            <li>VIP 01‚Äì03: 30 Gemas</li>
            <li>VIP 04‚Äì05: 60 Gemas</li>
            <li>VIP 06+: 120 Gemas</li>
          </ul>`
      },
      {
        day: 6,
        icon: "üéüÔ∏è",
        name: "Tickets Extra",
        amount: "3x",
        tagline: "M√°s entradas para giros o sorteos.",
        infoHtml: `
          <strong>Drop diario ‚Äì Bonus Tickets</strong>
          <ul>
            <li>Hasta <b>3 tickets extra</b></li>
            <li>VIP 01‚Äì03: 1 ticket</li>
            <li>VIP 04‚Äì05: 2 tickets</li>
            <li>VIP 06+: 3 tickets</li>
          </ul>`
      },
      {
        day: 7,
        icon: "üëë",
        name: "Gran Cofre Semana 1",
        amount: "1.7B + extras",
        tagline: "Cofre gigante si hiciste check-in los 7 d√≠as.",
        infoHtml: `
          <strong>Gran Cofre Semana 1</strong>
          <ul>
            <li>Se desbloquea con <b>7/7 check-ins</b></li>
            <li>VIP 01‚Äì03: 800M + 20 Free Spins</li>
            <li>VIP 04‚Äì05: 1.2B + 50 Free Spins</li>
            <li>VIP 06+: 1.7B + 100 Free Spins + drop misterioso</li>
          </ul>`
      }
    ];

    let selectedDay = Math.min(Math.max(todayInDecember, 1), 7);

    function renderWeekStrip() {
      if (!weekStrip) return;
      weekStrip.innerHTML = "";

      weekRewards.forEach((reward) => {
        const date = new Date(decYear, DECEMBER, reward.day);
        const dow = weekdayNames[date.getDay()];
        const isToday = reward.day === todayInDecember;
        const isPast = reward.day < todayInDecember;
        const isFuture = reward.day > todayInDecember;
        const isLocked = isFuture;

        const card = document.createElement("button");
        card.type = "button";
        card.className = "day-card";
        if (isToday) card.classList.add("today");
        if (isPast) card.classList.add("past");
        if (isLocked) card.classList.add("locked");
        if (reward.day === selectedDay) card.classList.add("active");

        let stateText = "Bloqueado üîí";
        if (isPast) stateText = "Reclamado ‚úÖ";
        if (isToday) stateText = "Drop de hoy üéØ";

        card.innerHTML = `
          <div class="day-top-row">
            <div>
              <div class="day-name">D√≠a ${reward.day}</div>
              <div class="day-date">${dow}, 1‚Äì7 Dic</div>
            </div>
          </div>
          <div class="day-main">
            <div class="day-icon">${reward.icon}</div>
            <div class="day-info-text">
              <div class="day-reward-name">${reward.name}</div>
              <div class="day-reward-amount">${reward.amount}</div>
            </div>
          </div>
          <div class="day-state">${stateText}</div>
          <div class="day-info-icon-wrap">
            <div class="day-info-icon">i</div>
          </div>
        `;

        card.addEventListener("click", () => {
          selectedDay = reward.day;
          renderWeekStrip();
          renderSelected();
          if (isToday && !isLocked) {
            copyVoucher(reward.day);
          }
        });

        const infoBtn = card.querySelector(".day-info-icon");
        infoBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          openInfoModal(reward);
        });

        weekStrip.appendChild(card);
      });
    }

    const selectedCardEl = selectedCard;

    function renderSelected() {
      if (!selectedCardEl) return;
      const reward =
        weekRewards.find((r) => r.day === selectedDay) || weekRewards[0];

      const isToday = reward.day === todayInDecember;
      const isPast = reward.day < todayInDecember;
      const isFuture = reward.day > todayInDecember;
      const isLocked = isFuture;
      const code = voucherCodes[reward.day];

      let status = "Bloqueado (todav√≠a no disponible)";
      if (isPast) status = "Ya reclamado esta semana.";
      if (isToday) status = "Activo ‚Äì usa tu c√≥digo hoy mismo.";

      selectedCardEl.innerHTML = `
        <div class="selected-icon">${reward.icon}</div>
        <div class="selected-main">
          <h3>${isToday ? "Drop de hoy" : "Recompensa d√≠a " + reward.day}</h3>
          <div class="amount">${reward.name} ‚Äì ${reward.amount}</div>
          <div class="tagline">${reward.tagline}</div>
        </div>
        <div class="selected-meta">
          <span>Estado: <strong>${status}</strong></span>
          <span>C√≥digo del d√≠a: <strong>${code}</strong></span>
          <span>Tip: copia el c√≥digo y p√©galo en el flujo de promo / dentro del juego para canjearlo.</span>
          <button id="copyCodeBtn" class="btn" ${isToday && !isLocked ? "" : "disabled"}>
            <span>üìã</span><span>Copiar c√≥digo de hoy</span>
          </button>
          <span style="font-size:10px; color:${isToday ? "#bbf7d0" : "#94a3b8"};">
            ${isToday
              ? "Solo el c√≥digo de hoy est√° activo. Se reinicia cada medianoche."
              : "C√≥digos pasados ya no son v√°lidos y los futuros a√∫n no se han habilitado."}
          </span>
        </div>
      `;

      const btn = document.getElementById("copyCodeBtn");
      if (btn && isToday && !isLocked) {
        btn.addEventListener("click", () => copyVoucher(reward.day));
      }
    }

    renderWeekStrip();
    renderSelected();

    // ---- Info modal ----
    const infoModal = document.getElementById("infoModal");
    const infoModalTitle = document.getElementById("infoModalTitle");
    const infoModalBody = document.getElementById("infoModalBody");
    const infoModalClose = document.getElementById("infoModalClose");

    function openInfoModal(reward) {
      infoModalTitle.textContent = `D√≠a ${reward.day} ‚Äì ${reward.name}`;
      infoModalBody.innerHTML = reward.infoHtml;
      infoModal.classList.add("show");
    }
    function closeInfoModal() {
      infoModal.classList.remove("show");
    }

    infoModalClose.addEventListener("click", closeInfoModal);
    infoModal.addEventListener("click", (e) => {
      if (e.target === infoModal || e.target.classList.contains("info-backdrop")) {
        closeInfoModal();
      }
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeInfoModal();
    });

    // ---- Clipboard + toast ----
    const toastEl = document.getElementById("toast");
    function showToast(msg) {
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      setTimeout(() => toastEl.classList.remove("show"), 1800);
    }

    function copyVoucher(day) {
      const code = voucherCodes[day];
      if (!code) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard
          .writeText(code)
          .then(() => showToast("C√≥digo copiado"))
          .catch(() => fallbackCopy(code));
      } else {
        fallbackCopy(code);
      }
    }
    function fallbackCopy(text) {
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      try {
        document.execCommand("copy");
        showToast("C√≥digo copiado");
      } catch {
        showToast("No se pudo copiar, copia manualmente.");
      }
      document.body.removeChild(ta);
    }

    // ---- Ranking / podium ----
    const rankingData = [
      { username: "ReyLatam", turnover: 110500 },
      { username: "FiestaSpin", turnover: 102300 },
      { username: "NavidadPro", turnover: 98500 },
      { username: "SambaCoins", turnover: 96200 },
      { username: "TacoRaid", turnover: 94100 },
      { username: "BrasilSpin", turnover: 92200 },
      { username: "AndesHero", turnover: 91000 },
      { username: "RioRunner", turnover: 89900 },
      { username: "LlamaLuck", turnover: 88100 },
      { username: "TangoJack", turnover: 87000 },
      { username: "ChiliGold", turnover: 85800 },
      { username: "PalmaSpin", turnover: 84400 },
      { username: "FiestaCode", turnover: 83100 },
      { username: "MayaCoins", turnover: 82000 },
      { username: "ArepaKing", turnover: 81200 },
      { username: "SambaByte", turnover: 80300 },
      { username: "CumbiaSpin", turnover: 79100 },
      { username: "PiscoRaid", turnover: 78300 },
      { username: "MateMaster", turnover: 77000 },
      { username: "CaribeLuck", turnover: 76000 }
    ];

    const extraRanks = [
      { username: "TuUsuario", turnover: 45210, rank: 54 },
      { username: "DemoPlayer", turnover: 51000, rank: 28 }
    ];

    const podiumGrid = document.getElementById("podiumGrid");
    const rankingList = document.getElementById("rankingList");
    const updatedAtEl = document.getElementById("updatedAt");
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");
    const searchResult = document.getElementById("searchResult");

    function shortNum(n) {
      if (n >= 1_000_000) return (n / 1_000_000).toFixed(1) + "M";
      if (n >= 1000) return (n / 1000).toFixed(1) + "K";
      return String(n);
    }
    function initials(name) {
      return name
        .split(/[^A-Za-z0-9]+/)
        .filter(Boolean)
        .slice(0, 2)
        .map((p) => p[0].toUpperCase())
        .join("");
    }

    const now = new Date();
    if (updatedAtEl) {
      updatedAtEl.textContent =
        "Actualizado " +
        now.toLocaleTimeString(undefined, { hour: "2-digit", minute: "2-digit" });
    }

    if (podiumGrid) {
      rankingData.slice(0, 3).forEach((player, index) => {
        const rank = index + 1;
        const div = document.createElement("div");
        div.className = "podium-item rank-" + rank;
        div.innerHTML = `
          <div class="podium-rank">#${rank}</div>
          <div class="podium-avatar">${initials(player.username)}</div>
          <div class="podium-name">${player.username}</div>
          <div class="podium-turnover">${shortNum(player.turnover)} TO</div>
        `;
        podiumGrid.appendChild(div);
      });
    }

    if (rankingList) {
      rankingData.forEach((player, index) => {
        const rank = index + 1;
        const row = document.createElement("div");
        row.className = "ranking-row";
        if (rank <= 3) row.classList.add("highlight");
        row.innerHTML = `
          <div class="rank-badge">#${rank}</div>
          <div class="rank-main">
            <div class="rank-avatar">${initials(player.username)}</div>
            <div class="rank-name">${player.username}</div>
          </div>
          <div class="rank-turnover">
            ${shortNum(player.turnover)}
            <span class="label">Turnover</span>
          </div>
        `;
        rankingList.appendChild(row);
      });
    }

    function findRank(nameRaw) {
      const name = nameRaw.trim().toLowerCase();
      if (!name) return null;

      const idx = rankingData.findIndex(
        (p) => p.username.toLowerCase() === name
      );
      if (idx >= 0) {
        return { ...rankingData[idx], rank: idx + 1, inTop20: true };
      }
      const extra = extraRanks.find(
        (p) => p.username.toLowerCase() === name
      );
      if (extra) return { ...extra, inTop20: false };
      return null;
    }

    function handleSearch() {
      if (!searchInput || !searchResult) return;
      const q = searchInput.value;
      if (!q.trim()) {
        searchResult.textContent = "";
        return;
      }
      const res = findRank(q);
      if (!res) {
        searchResult.innerHTML =
          `No encontramos <strong>${q}</strong> todav√≠a. Aseg√∫rate de estar en la hoja de Google del evento.`;
        return;
      }
      if (res.inTop20) {
        searchResult.innerHTML =
          `<strong>${res.username}</strong> est√° en <strong>#${res.rank}</strong> ` +
          `con <strong>${shortNum(res.turnover)}</strong> turnover.`;
        const row = rankingList.children[res.rank - 1];
        if (row) {
          row.classList.add("highlight");
          row.scrollIntoView({ behavior: "smooth", block: "center" });
        }
      } else {
        searchResult.innerHTML =
          `<strong>${res.username}</strong> est√° en <strong>#${res.rank}</strong> ` +
          `con <strong>${shortNum(res.turnover)}</strong> turnover (fuera del top 20 visible).`;
      }
    }

    if (searchBtn) {
      searchBtn.addEventListener("click", handleSearch);
      searchInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") handleSearch();
      });
    }

    // ---- Tabs / navigation ----
    const navButtons = document.querySelectorAll(".nav-btn");
    const tabPanels = {
      home: document.getElementById("tab-home"),
      rewards: document.getElementById("tab-rewards"),
      ranking: document.getElementById("tab-ranking")
    };

    function setActiveTab(target) {
      Object.entries(tabPanels).forEach(([key, el]) => {
        if (!el) return;
        el.classList.toggle("active", key === target);
      });
      navButtons.forEach((btn) => {
        const active = btn.dataset.tabTarget === target;
        btn.classList.toggle("active", active);
      });
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    navButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.tabTarget;
        if (target) setActiveTab(target);
      });
    });

    document.querySelectorAll("[data-goto-tab]").forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.gotoTab;
        if (target) setActiveTab(target);
      });
    });
  </script>
</body>
</html>
